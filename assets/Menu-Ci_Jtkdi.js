import{u as N,a as y,b as L,c as C,r as u,F as l,d as B,e as I,j as s,f as R,g as w,h as F,s as b,C as $}from"./index-DZv4DeV4.js";import{q as A,L as T,F as U,A as E,a as D,C as G,D as O}from"./index--UaR9W_6.js";import"./react-content-loader.es-Bo-GOqjf.js";const M=e=>{const{getAll:r}=N(),{status:c}=y(),{setCategory:t,setSubcategory:g,setSort:a,setSearchedItemId:m}=L(),{currentCategory:d,categories:o,sortTypes:_,subcategories:n}=C();u.useEffect(()=>{if(e){const h=A.parse(e.substring(1).replace("(asc)","%2B")),p=o.find(v=>v.value===h.category),i=n.find(v=>v.value===h.subcategory),x=_.find(v=>v.value===h.sortBy),k=h.item;p&&t(p),i&&g(i),x&&a(x),k&&m(+k)}else a(_[3]),t(o[0]);c===l.LOADING&&r(d.value)},[e])},P="_assortment_rt2yp_1",V={assortment:P},q=()=>{const e=B(),{search:r}=I(),{findItem:c,getByCategory:t,sortItems:g}=N(),{status:a,items:m}=y(),{currentSortType:d,currentCategory:o,searchedItemId:_,currentSubcategory:n}=C();u.useEffect(()=>{a===l.SUCCESS&&_&&c(_)},[a]),u.useEffect(()=>{a===l.SUCCESS&&g(d.value)},[o,a]),u.useEffect(()=>{if(a===l.SUCCESS){const p=A.stringify(o.value==="drinkables"?{category:o.value,subcategory:n.value,sortBy:d.value}:{category:o.value,sortBy:d.value});e(`?${p.replace("%2B","(asc)")}`)}},[d,o,n]),u.useEffect(()=>{a===l.SUCCESS&&t(o.value)},[o,n]),M(r);const h=p=>p===l.LOADING?[...Array(6)].map((i,x)=>s.jsx(T,{},x)):p===l.ERROR?s.jsx(U,{}):m==null?void 0:m.map(i=>o.value==="drinkables"?i.subcategory===n.name&&s.jsx(E,{item:i},i.id):s.jsx(E,{item:i},i.id));return s.jsx("div",{className:V.assortment,children:h(a)})},z="_shining_gltrb_1",W="_buttonShining_gltrb_1",H="_sort_gltrb_19",J="_label_gltrb_36",K="_icon_gltrb_42",Q="_options_list_gltrb_48",X="_popUp_gltrb_1",Y="_active_gltrb_71",Z="_hide_gltrb_76",f={shining:z,buttonShining:W,sort:H,label:J,icon:K,options_list:Q,popUp:X,active:Y,hide:Z},ss=()=>{const[e,r]=u.useState(!1),{filtersStore:c,assortmentStore:t}=R(),{currentSortType:g,sortTypes:a}=c.getters,{setSort:m}=c.actions,{sortItems:d}=t.actions,o=u.useRef(null),_=n=>{m(n),r(!e),d(n.value)};return u.useEffect(()=>{const n=h=>{o.current&&!h.composedPath().includes(o.current)&&r(!1)};return document.body.addEventListener("click",n),()=>document.body.removeEventListener("click",n)},[]),s.jsxs("div",{ref:o,className:f.sort,children:["Сортировка по ",s.jsx("span",{className:f.label,onClick:()=>r(!e),children:g.name}),s.jsx("svg",{className:f.icon,onClick:()=>r(!e),width:"15",height:"10",viewBox:"0 0 30 21",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M2.5 19L15 4L27.5 19",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})}),s.jsx("div",{className:w(f.options_list,{[f.hide]:!e}),children:a.map(n=>s.jsx("p",{className:w({[f.active]:g.value===n.value}),onClick:()=>_(n),children:n.name},n.value))})]})},ts="data:image/svg+xml,%3csvg%20width='30'%20height='21'%20viewBox='0%200%2030%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2.5%2019L15%204L27.5%2019'%20stroke='white'%20stroke-width='4'%20stroke-linecap='round'/%3e%3c/svg%3e",es="_shining_1n6gc_1",ns="_buttonShining_1n6gc_1",os="_button_1n6gc_19",rs="_show_1n6gc_38",as="_icon_1n6gc_43",j={shining:es,buttonShining:ns,button:os,show:rs,icon:as},cs=({isShown:e,...r})=>s.jsx("button",{className:w(j.button,{[j.show]:e}),onClick:()=>window.scrollTo(0,0),...r,children:s.jsx("img",{className:j.icon,src:ts,alt:"К началу страницы"})}),S="/assets/banner_loader-DVqi086V.webp",is=()=>{const{banners:e,status:r}=y(),{currentCategory:c}=C(),t=e==null?void 0:e[c.value];return r===l.LOADING?[S,S,S]:[`${t==null?void 0:t["1600"]} 1600w`,`${t==null?void 0:t["820"]} 820w`,`${t==null?void 0:t["420"]} 420w`].map(g=>g??S)},ds=()=>{const e=is(),{searchedItem:r,status:c}=y(),{inView:t}=F();return u.useEffect(()=>{window.scrollTo(0,0)},[]),s.jsxs(s.Fragment,{children:[s.jsx(D,{isOpen:!!r}),s.jsx("div",{className:b.banner_wrapper,children:s.jsx("img",{className:b.menu_banner,srcSet:e.join(", "),style:{display:c===l.ERROR?"none":"block"},alt:"banner",loading:"lazy",decoding:"async"})}),s.jsxs("div",{className:b.menu_wrapper,children:[s.jsx(G,{navRange:[0,-2],isFixed:!t}),s.jsx(ss,{}),s.jsx(q,{}),s.jsx(cs,{isShown:!t}),s.jsxs("div",{className:w(b.check_wrapper,{[b.fixed]:t}),children:[s.jsx(O,{}),s.jsx($,{})]})]})]})};export{ds as default};
