import{u as I,a as $,b as y,c as F,d as C,r as l,F as i,R as A,e as T,j as s,f as U,g as w,h as O,s as S,C as D}from"./index-DF4WTWj_.js";import{q as B,L as G,F as M,A as R,a as P,C as V,D as q}from"./index-B7swG-b_.js";import"./react-content-loader.es-CtttPpow.js";const z=e=>{const{pathname:r}=I(),{get:c,getBanners:t,getSpecificsIcons:u}=$(),{status:a}=y(),{setCategory:g,setSubcategory:d,setSort:o,setSearchedItemId:_}=F(),{currentCategory:n,categories:p,sortTypes:m,subcategories:h}=C();l.useEffect(()=>{if(e){const f=B.parse(e.substring(1).replace("(asc)","%2B")),k=p.find(b=>b.value===f.category),E=h.find(b=>b.value===f.subcategory),N=m.find(b=>b.value===f.sortBy),L=f.item;k&&g(k),E&&d(E),N&&o(N),L&&_(+L)}else o(m[3]),g(p[0]);a===i.LOADING&&(c(n.value),u()),r===`${A.base}${A.main}`&&t()},[])},W="_assortment_rt2yp_1",H={assortment:W},J=()=>{const e=T(),{search:r}=I(),{findItem:c,get:t,sortItems:u}=$(),{status:a,items:g}=y(),{currentSortType:d,currentCategory:o,searchedItemId:_,currentSubcategory:n}=C();z(r),l.useEffect(()=>{a===i.SUCCESS&&_&&c(_)},[a]),l.useEffect(()=>{a===i.SUCCESS&&u(d.value)},[o,a]),l.useEffect(()=>{if(a===i.SUCCESS){const m=B.stringify(o.value==="drinkables"?{category:o.value,subcategory:n.value,sortBy:d.value}:{category:o.value,sortBy:d.value});e(`?${m.replace("%2B","(asc)")}`)}},[d,o,n]),l.useEffect(()=>{a===i.SUCCESS&&t(o.value)},[o,n]);const p=m=>m===i.LOADING?[...Array(6)].map((h,f)=>s.jsx(G,{},f)):m===i.ERROR?s.jsx(M,{}):g==null?void 0:g.map(h=>o.value==="drinkables"?h.subcategory===n.name&&s.jsx(R,{item:h},h.id):s.jsx(R,{item:h},h.id));return s.jsx("div",{className:H.assortment,children:p(a)})},K="_shining_gltrb_1",Q="_buttonShining_gltrb_1",X="_sort_gltrb_19",Y="_label_gltrb_36",Z="_icon_gltrb_42",ss="_options_list_gltrb_48",ts="_popUp_gltrb_1",es="_active_gltrb_71",ns="_hide_gltrb_76",v={shining:K,buttonShining:Q,sort:X,label:Y,icon:Z,options_list:ss,popUp:ts,active:es,hide:ns},os=()=>{const[e,r]=l.useState(!1),{filtersStore:c,assortmentStore:t}=U(),{currentSortType:u,sortTypes:a}=c.getters,{setSort:g}=c.actions,{sortItems:d}=t.actions,o=l.useRef(null),_=n=>{g(n),r(!e),d(n.value)};return l.useEffect(()=>{const n=p=>{o.current&&!p.composedPath().includes(o.current)&&r(!1)};return document.body.addEventListener("click",n),()=>document.body.removeEventListener("click",n)},[]),s.jsxs("div",{ref:o,className:v.sort,children:["Сортировка по ",s.jsx("span",{className:v.label,onClick:()=>r(!e),children:u.name}),s.jsx("svg",{className:v.icon,onClick:()=>r(!e),width:"15",height:"10",viewBox:"0 0 30 21",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M2.5 19L15 4L27.5 19",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})}),s.jsx("div",{className:w(v.options_list,{[v.hide]:!e}),children:a.map(n=>s.jsx("p",{className:w({[v.active]:u.value===n.value}),onClick:()=>_(n),children:n.name},n.value))})]})},rs="data:image/svg+xml,%3csvg%20width='30'%20height='21'%20viewBox='0%200%2030%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2.5%2019L15%204L27.5%2019'%20stroke='white'%20stroke-width='4'%20stroke-linecap='round'/%3e%3c/svg%3e",as="_shining_1n6gc_1",cs="_buttonShining_1n6gc_1",is="_button_1n6gc_19",ls="_show_1n6gc_38",us="_icon_1n6gc_43",j={shining:as,buttonShining:cs,button:is,show:ls,icon:us},gs=({isShown:e,...r})=>s.jsx("button",{className:w(j.button,{[j.show]:e}),onClick:()=>window.scrollTo(0,0),...r,children:s.jsx("img",{className:j.icon,src:rs,alt:"К началу страницы"})}),x="/sushidream/assets/banner_loader-DVqi086V.webp",ds=()=>{const{banners:e,status:r}=y(),{currentCategory:c}=C(),t=e==null?void 0:e[c.value];return r===i.LOADING?[x,x,x]:[`${t==null?void 0:t["1600"]} 1600w`,`${t==null?void 0:t["820"]} 820w`,`${t==null?void 0:t["420"]} 420w`].map(u=>u??x)},ps=()=>{const e=ds(),{searchedItem:r,status:c}=y(),{inView:t}=O();return l.useEffect(()=>{window.scrollTo(0,0)},[]),s.jsxs(s.Fragment,{children:[s.jsx(P,{isOpen:!!r}),s.jsx("div",{className:S.banner_wrapper,children:s.jsx("img",{className:S.menu_banner,srcSet:e.join(", "),style:{display:c===i.ERROR?"none":"block"},alt:"banner",loading:"lazy",decoding:"async"})}),s.jsxs("div",{className:S.menu_wrapper,children:[s.jsx(V,{navRange:[0,-2],isFixed:!t}),s.jsx(os,{}),s.jsx(J,{}),s.jsx(gs,{isShown:!t}),s.jsxs("div",{className:w(S.check_wrapper,{[S.fixed]:t}),children:[s.jsx(q,{}),s.jsx(D,{})]})]})]})};export{ps as default};
